version: "1"

services:
  # üåê Flask Dashboard (web)
  - type: web
    name: messiahbot-dashboard
    env: python
    plan: starter
    autoDeploy: true
    branch: main
    buildCommand: pip install -r requirements.txt
    startCommand: gunicorn "bot.dashboard_messiah:app" --bind 0.0.0.0:$PORT
    healthCheckPath: /ping
    envVars:
      - fromGroup: messiahbot-core
      - key: PORT
        value: 10000

  # ü§ñ Main Discord/Twitch bot logic
  - type: worker
    name: messiahbot-worker
    env: python
    plan: starter
    autoDeploy: true
    branch: main
    buildCommand: pip install -r requirements.txt
    startCommand: python -m bot.messiahbot_dc
    envVars:
      - fromGroup: messiahbot-core

  # üìÖ Twitch/Discord schedule sync worker
  - type: worker
    name: messiahbot-twitch-sync
    env: python
    plan: starter
    autoDeploy: true
    branch: main
    buildCommand: pip install -r requirements.txt
    startCommand: python -m bot.sync_worker
    envVars:
      - fromGroup: messiahbot-core
